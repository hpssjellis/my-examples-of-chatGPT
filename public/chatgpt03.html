<html>
<head>
  <title>Webcam Images v2</title>
</head>
<body>
  <h1>Webcam Images</h1>
  <video id="myWebcam" width="400" height="300"></video>
  <br>
  <button onclick="takePicture()">Take Picture</button>
  <br>
  <button onclick="viewPictures()">View Pictures</button>
  <br>
  <div id="myPictures"></div>
  <script>
    // set up webcam
    const myWebcam = document.getElementById("myWebcam");
    const constraints = {
      video: true
    };
    navigator.mediaDevices.getUserMedia(constraints)
      .then(function(stream) {
        myWebcam.srcObject = stream;
      })
      .catch(function(error) {
        console.error("Error: ", error);
      });

// take picture and save to localStorage
function takePicture() {
  // create canvas to draw image onto
  const myCanvas = document.createElement("canvas");
  myCanvas.width = myWebcam.videoWidth;
  myCanvas.height = myWebcam.videoHeight;
  const myContext = myCanvas.getContext("2d");
  myContext.drawImage(myWebcam, 0, 0);

  // get current date and time for file name
  const myDate = new Date();
  const myFileName = myDate.toISOString();

  // convert canvas to png and save to localStorage
  const myImage = myCanvas.toDataURL("image/png");
  localStorage.setItem(myFileName, myImage);
}

// view all images in localStorage
function viewPictures() {
  // clear previous images
  const myPictures = document.getElementById("myPictures");
  myPictures.innerHTML = "";

  // loop through all items in localStorage
  for (let i = 0; i < localStorage.length; i++) {
    // get key and value for each item
    const myKey = localStorage.key(i);
    const myValue = localStorage.getItem(myKey);

    // create image element and set src to stored image
    const myImage = document.createElement("img");
    myImage.src = myValue;

    // append image to div
    myPictures.appendChild(myImage);
  }
}
  </script>
</body>
</html>
