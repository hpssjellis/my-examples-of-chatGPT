<!DOCTYPE html>
<html>
<head>
    <title>Laundry Training with TensorflowJS</title>
</head>
<body>
<h1>Laundry Training with TensorflowJS</h1>
<p>This page will train a TensorflowJS vision machine learning model with the label "laundry" using grayscale 320 by 320 PNG images from the computer disk.</p>
<!-- Load TensorflowJS library -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<!-- Load grayscale PNG images from computer disk -->
<input type="file" id="myFiles" multiple accept="image/png" />
<!-- Train and compile model -->
<script>
    // Get input element and files
    const myFilesInput = document.getElementById('myFiles');
    const myFiles = myFilesInput.files;

    // Create empty tensor for images
    const myTensor = tf.tensor4d([], [myFiles.length, 320, 320, 1]);

    // Loop through files to add each image to tensor
    for (let i = 0; i < myFiles.length; i++) {
        const myFile = myFiles[i];
        const myImage = new Image();
        myImage.src = URL.createObjectURL(myFile);
        myTensor.set(tf.browser.fromPixels(myImage, 1), i);
    }

    // Create model
    const myModel = tf.sequential();

    // Add convolutional layer
    myModel.add(tf.layers.conv2d({
        inputShape: [320, 320, 1],
        filters: 32,
        kernelSize: 3,
        strides: 1,
        activation: 'relu'
    }));

    // Add max pooling layer
    myModel.add(tf.layers.maxPooling2d({
        poolSize: [2, 2],
        strides: [2, 2]
    }));

    // Add flatten layer
    myModel.add(tf.layers.flatten());

    // Add dense layer
    myModel.add(tf.layers.dense({
        units: 128,
        activation: 'relu'
    }));

    // Add output layer
    myModel.add(tf.layers.dense({
        units: 1,
        activation: 'sigmoid'
    }));

    // Compile model
    myModel.compile({
        optimizer: tf.train.adam(),
        loss: 'binaryCrossentropy',
        metrics: ['accuracy']
    });

    // Train model
    myModel.fit(myTensor, tf.tensor1d([1, 1, 1, ...]), {
        epochs: 10
    }).then(() => {
        // Save compiled model to disk
        myModel.save('downloads://myModel');
    });
</script>
</body>
</html>
